package ventanas;

import java.awt.*;
import java.awt.event.*;
import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.util.*;
import javax.swing.*;
import javax.swing.table.*;

public class MostrandoPREP {
	private JTable tabla;
	private JScrollPane panelScroll;
	private String titColumna[];
	private String datoColumna[][];
	JPanel JP;
//	String RPF;		//Ruta Plus Filename
	FileReader FR;
	BufferedReader BR;
	String linea;
	StringTokenizer ST;
	int NumDLinesMinOne;
	
	public MostrandoPREP(File file){
//		RPF=rutaplusfilename;
		JP = new JPanel();
		JP.setLayout(new BorderLayout());
		try {
			FR=new FileReader(file);
			BR = new BufferedReader(FR);
			CreaColumnas();
			ContarLineasFile(file);
			CargaDatos();
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		tabla = new JTable(datoColumna, titColumna);
		// Aquí se configuran algunos de los parámetros que permite
		// variar la JTable
		tabla.setShowHorizontalLines(true);
		tabla.setRowSelectionAllowed(true);
		tabla.setColumnSelectionAllowed(true);
		// Cambiamos el color de la zona seleccionada (rojo/blanco)
		tabla.setSelectionForeground(Color.white);
		tabla.setSelectionBackground(Color.red);
		// Incorporamos la tabla a un panel que incorpora ya una barra
		// de desplazamiento, para que la visibilidad de la tabla sea
		// automática
		tabla.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);//ESTO ES PARA QUE SE MUESTRE 
		tabla.doLayout();					//LA BARRA DE DESPLAZAMIENTOHORIZONTAL 
		panelScroll = new JScrollPane(tabla);
		JP.add(panelScroll, BorderLayout.CENTER);
	}//end MostrandoPREP()
	
	public void CreaColumnas() throws IOException {
		linea=BR.readLine();
		ST=new StringTokenizer(linea,",");
		System.out.println("ST.countTokens():"+ST.countTokens());
		titColumna = new String[ST.countTokens()];
		for (int i = 0; i < titColumna.length; i++) {
			titColumna[i] = ST.nextToken();
		}
	}//end CrearColumnas()
	
	public void CargaDatos() throws IOException {
		linea=BR.readLine();
		ST=new StringTokenizer(linea,",");
		datoColumna = new String[NumDLinesMinOne][ST.countTokens()];
		for (int iY = 0; iY < datoColumna[0].length; iY++) {
			for (int iX = 0; iX < datoColumna.length; iX++) {
				datoColumna[iY][iX] = ST.nextToken();
			}
			linea=BR.readLine();
			ST=new StringTokenizer(linea);
		}
	}
	void ContarLineasFile(File f) throws IOException{
		int count=0;
		FR=new FileReader(f);
		while((linea=BR.readLine())!=null){
			count++;
		}
		NumDLinesMinOne=count-1;
	}

	public static void main(String[] args) {
		JFrame ventana = new JFrame("Un Archivo PREP");
		ventana.addWindowListener(new WindowAdapter() {
			public void windowClosing(WindowEvent evt) {
				System.exit(0);
			}
		});
		JFileChooser JFC=new JFileChooser();
		int retVal = JFC.showOpenDialog(new JFrame());
		if (retVal == JFileChooser.APPROVE_OPTION) {
			File file = JFC.getSelectedFile();
			MostrandoPREP mp=new MostrandoPREP(file);
			ventana.getContentPane().add(mp.JP,BorderLayout.CENTER );
		    ventana.setSize( 800,400 );
		    ventana.setLocationRelativeTo(null);
		    
		    ventana.setVisible( true );
		}
	}//end main()
}//end class MostrandoPREP
